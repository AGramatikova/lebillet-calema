<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Calema | LeBillet</title>
<style>
  * { 
    box-sizing: border-box; 
    margin: 0; 
    padding: 0; 
  }

  html, body {
    width: 100%;
    max-width: 100%;
    overflow-x: hidden !important;
    background-color: #04153b;
    color: white;
    font-family: 'Poppins', sans-serif;
    height: 100%;
    position: fixed;
    overflow: hidden;
  }

  #main-content {
    position: relative;
    height: 100vh;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
  }

  #main-content button {
    background: #64d869; 
    border: none; 
    color: #fff;
    font-size: 1.2rem; 
    padding: 15px 40px; 
    border-radius: 8px;
    cursor: pointer; 
    transition: background 0.3s;
  }
  
  #main-content button:hover { 
    background: #4ec556; 
  }

  /* SECTION (desktop default modal) */
  #calema-section {
    display: none;
    position: fixed; 
    top: 50%; 
    left: 50%;
    transform: translate(-50%, -50%);
    width: 85%; 
    height: 85vh;
    border-radius: 16px; 
    background: #04153b;
    box-shadow: 0 0 40px rgba(0,0,0,0.5);
    z-index: 1000; 
    overflow-y: auto;
    transition: transform 0.4s ease;
  }

  /* Decorative blobs */
  .blob { 
    position: absolute; 
    border-radius: 50%; 
    filter: blur(100px); 
    opacity: 0.55; 
    z-index: 0; 
  }
  
  .blob1 { 
    width: 300px; 
    height: 400px; 
    background: #0b5cff; 
    top: 25%; 
    left: -5%; 
  }
  
  .blob2 { 
    width: 400px; 
    height: 400px; 
    background: #0099ff; 
    bottom: -10%; 
    right: -5%; 
  }
  
  #calema-section *:not(.blob) { 
    position: relative; 
    z-index: 2; 
  }

  /* Title Bar */
  .title-bar {
    width: 80%; 
    height: 100px; 
    background: #dcdcdc;
    margin: -23px auto 0 auto;
    clip-path: polygon(0 0, 100% 0, 100% 22%, 60% 85%, 40% 85%, 0 22%);
    display: flex; 
    justify-content: center; 
    align-items: center;
  }
  
  .title-bar h2 { 
    color: #04153b; 
    font-size: 2rem; 
    font-weight: 700; 
    letter-spacing: 2px; 
  }

  .content {
    display: flex; 
    justify-content: space-between; 
    flex-wrap: wrap;
    gap: 30px; 
    padding: 40px; 
    align-items: flex-start;
  }

  /* Left pane */
  .left-pane {
    flex: 1; 
    min-width: 350px;
    display: flex; 
    flex-direction: column; 
    gap: 20px;
  }

  /* Toolbar (Voltar + Promo) */
  .left-toolbar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 25px;
    width: 100%;
  }

  .back-btn-global {
    position: static;
    background: rgba(255,255,255,0.1);
    border: 1px solid rgba(255,255,255,0.3);
    border-radius: 8px;
    color: white;
    padding: 8px 14px;
    cursor: pointer;
    transition: 0.3s;
  }
  
  .back-btn-global:hover { 
    background: rgba(255,255,255,0.2); 
  }

  .promo-btn {
    background: #e0e0e0; 
    color: #000; 
    border: none; 
    padding: 10px 20px;
    border-radius: 6px; 
    cursor: pointer; 
    font-weight: 600; 
    transition: background 0.3s;
  }
  
  .promo-btn:hover { 
    background: #c3c3c3; 
  }

  /* Coupon */
  .coupon-section {
    display: none; 
    margin: 5px 0 15px 0; 
    gap: 10px; 
    justify-content: flex-start;
  }
  
  .coupon-section input { 
    flex: 1; 
    padding: 10px; 
    border-radius: 6px; 
    border: none; 
    font-size: 0.9rem; 
  }
  
  .coupon-section button {
    background: #a0b0c0; 
    border: none; 
    padding: 10px 15px; 
    border-radius: 6px;
    color: #333333; 
    font-weight: 600; 
    cursor: pointer; 
    transition: background 0.3s;
  }
  
  .coupon-section button:hover { 
    background: #64d869; 
  }

  /* Tickets */
  .ticket-box {
    background: rgba(255,255,255,0.08);
    border-radius: 12px;
    padding: 15px 20px;
    margin-top: 25px;
    margin-bottom: 15px;
  }

  .ticket-row { 
    display: flex; 
    justify-content: space-between; 
    align-items: center; 
    margin-top: 22px; 
  }
  
  .price-row { 
    display: flex; 
    align-items: center; 
    gap: 16px; 
  }

  .quantity-select {
    background: transparent !important; 
    color: white !important;
    border: 1px solid rgba(255,255,255,0.5); 
    border-radius: 6px;
    padding: 7px 8px; 
    font-size: 1rem; 
    font-weight: 600; 
    width: 60px; 
    cursor: pointer;
    -webkit-appearance: none !important; 
    -moz-appearance: none !important; 
    appearance: none !important;
    backdrop-filter: blur(10px);
  }

  /* Cart */
  .cart-box {
    background: transparent; 
    border-left: 1px solid rgba(255,255,255,0.3);
    padding: 0 0 0 40px; 
    flex: 1; 
    min-width: 350px;
  }

  .cart-title { 
    display: flex; 
    align-items: center; 
    gap: 8px; 
    margin-bottom: 35px; 
  }
  
  .cart-icon {
    width: 22px;
    height: 24px;
    fill: #fff;
    opacity: 0.9;
    margin-top: 8px;
    margin-left: 0;
  }

  .cart-item { 
    width: 100%; 
  }

  .cart-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 14px;
  }

  .cart-header p {
    font-weight: 700;
    font-size: 1.3rem;
    margin: 0;
  }

  .remove-btn {
    background: transparent;
    border: none;
    color: #ff4d4d;
    font-size: 1.2rem;
    font-weight: bold;
    cursor: pointer;
    line-height: 1;
    transition: color 0.2s ease;
    display: none;
  }
  
  .remove-btn:hover { 
    color: #ff1a1a; 
  }

  /* Updated cart item spacing + grey tone */
  .cart-line {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin: 10px 0 20px 0;
    gap: 10px;
  }

  .cart-box small {
    display: block;
    margin-top: 4px;
    font-size: 0.9rem;
    color: #bfbfbf;
    opacity: 0.7;
    text-align: left;
  }

  .cart-item small {
    display: block;
    margin-top: 10px;
    font-size: 0.9rem;
    opacity: 0.8;
    text-align: left;
  }

  hr { 
    border: 0.5px solid rgba(255,255,255,0.2); 
    margin: 40px 0; 
  }
  
  .costs p, .total p { 
    display: flex; 
    justify-content: space-between; 
    margin: 5px 0; 
  }
  
  .total { 
    font-size: 1.2rem; 
    margin-top: 70px; 
  }

  .continue-btn {
    display: block;
    background: #4ec556; 
    color: #fff; 
    border: none; 
    border-radius: 8px; 
    width: 65%;
    padding: 15px; 
    margin: 55px auto 0 auto; 
    cursor: pointer; 
    font-size: 1rem; 
    transition: background 0.3s;
    text-align: center;
  }
  
  .continue-btn:hover { 
    background: #62dd68; 
  }

  /* Payment form */
  .payment-form {
    display: none;
    color: #fff; 
    padding: 15px 20px;
    opacity: 0; 
    transform: translateY(20px);
    transition: all 0.25s ease-in-out;
    background: none;
    border-radius: 12px;
  }
  
  .payment-form.active { 
    display: block !important; 
    opacity: 1; 
    transform: translateY(0); 
  }

  .payment-form input, .payment-form select {
    width: 100%; 
    padding: 10px; 
    border-radius: 6px; 
    border: 1px solid rgba(255,255,255,0.5);
    background: transparent; 
    color: #fff; 
    margin-bottom: 12px; 
    font-size: 1rem;
  }

  /* Phone row styling */
  .phone-row {
    display: flex;
    gap: 0;
    border: 1px solid rgba(255,255,255,0.5);
    border-radius: 6px;
    overflow: hidden;
    margin-bottom: 12px;
    background: transparent;
  }

  .phone-row select {
    border: none !important;
    border-right: 1px solid rgba(255,255,255,0.3) !important;
    border-radius: 0 !important;
    margin-bottom: 0 !important;
    flex-shrink: 0;
    width: auto;
    padding-right: 30px;
    box-shadow: none !important;
    outline: none !important;
    font-size: 0.85rem;
  }

  .phone-row input {
    border: none !important;
    border-radius: 0 !important;
    margin-bottom: 0 !important;
    flex: 1;
    box-shadow: none !important;
    outline: none !important;
  }

  .phone-row select:focus,
  .phone-row input:focus {
    box-shadow: none !important;
    border: none !important;
    outline: none !important;
  }

  .phone-row:focus-within {
    border-color: #64d869;
    box-shadow: 0 0 5px rgba(100,216,105,0.4);
  }

  /* Voltar inside payment form */
  #backBtnPayment {
    align-self: flex-start;
    margin-bottom: 15px;
    background: rgba(255,255,255,0.1);
    border: 1px solid rgba(255,255,255,0.3);
    border-radius: 8px;
    color: white;
    padding: 8px 14px;
    cursor: pointer;
    transition: 0.3s;
  }
  
  #backBtnPayment:hover { 
    background: rgba(255,255,255,0.2); 
  }

  /* Hide left-side continue button (payment) on desktop */
  .payment-actions { 
    display: none; 
  }

  /* Keep it visible only on mobile */
  @media (max-width: 768px) {
    #calema-section {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      top: auto;
      width: 100vw;
      max-width: 100vw;
      max-height: 40vh;
      height: auto;
      background: #04153b;
      border-top-left-radius: 20px;
      border-top-right-radius: 20px;
      border-bottom-left-radius: 0;
      border-bottom-right-radius: 0;
      box-shadow: 0 -4px 25px rgba(0,0,0,0.5);
      transform: translateY(100%);
      transition: transform 0.4s ease-out;
      overflow-y: auto;
      overflow-x: hidden;
      z-index: 1000;
      padding: 0;
      margin: 0;
    }

    #calema-section.active {
      transform: translateY(0);
    }
    
    .title-bar { 
      width: 100%; 
      height: 85px; 
    }
    
    .title-bar h2 { 
      font-size: 1.5rem; 
    }

    .content { 
      flex-direction: column; 
      padding: 20px; 
      gap: 16px;
      max-width: 100vw;
      overflow-x: hidden;
    }

    .cart-box {
      display: none;
      padding: 0;
      border: none;
      margin-top: 10px;
      width: 100%;
      text-align: center;
    }

    .cart-box.visible {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .continue-btn {
      position: sticky;
      bottom: 10px;
      width: 100%;
      padding: 14px;
      border-radius: 10px;
      margin: 24px 0 0 0;
    }

    .left-pane { 
      width: 100%; 
    }
    
    .payment-form { 
      display: none; 
      width: 100%; 
      padding: 16px; 
    }
    
    .payment-form.active { 
      display: block !important; 
    }

    .payment-actions {
      display: flex;
      justify-content: center !important;
      margin-top: 20px;
      width: 100%;
    }

    .pay-continue-btn {
      background: #64d869;
      border: none;
      color: #04153b;
      font-weight: 700;
      padding: 15px;
      border-radius: 10px;
      cursor: pointer;
      width: 100%;
      font-size: 1rem;
      text-align: center;
      transition: background 0.3s;
    }

    .pay-continue-btn:hover { 
      background: #62dd68; 
    }

    /* extra spacing for mobile */
    .left-toolbar {
      margin-bottom: 30px;
    }
    
    .ticket-box {
      margin-top: 30px;
    }
  }

  /* Unified transparent inputs + selects */
  select,
  .quantity-select,
  .phone-row select {
    background: transparent !important;
    color: white !important;
    border: 1px solid rgba(255,255,255,0.5);
    border-radius: 6px;
    padding: 10px;
    font-size: 1rem;
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    appearance: none !important;
  }

  select option,
  .quantity-select option,
  .phone-row select option {
    background: #04153b !important;
    color: white !important;
  }

  select:focus,
  .quantity-select:focus,
  .phone-row select:focus {
    outline: none;
    border-color: #64d869;
    box-shadow: 0 0 5px rgba(100,216,105,0.4);
  }

  input[type="text"],
  input[type="email"],
  input[type="tel"] {
    transition: all 0.3s ease;
    background: transparent;
    color: white;
    border: 1px solid rgba(255,255,255,0.5);
    border-radius: 6px;
  }

  input[type="text"]:focus,
  input[type="email"]:focus,
  input[type="tel"]:focus {
    outline: none;
    border-color: #64d869;
    box-shadow: 0 0 5px rgba(100,216,105,0.4);
  }

  ::placeholder { 
    color: white !important; 
    opacity: 0.5 !important; 
  }
  
  ::-webkit-input-placeholder { 
    color: white !important; 
    opacity: 0.5 !important; 
  }
  
  :-ms-input-placeholder { 
    color: white !important; 
    opacity: 0.5 !important; 
  }
  
  ::-moz-placeholder { 
    color: white !important; 
    opacity: 0.5 !important; 
  }
  
  :-moz-placeholder { 
    color: white !important; 
    opacity: 0.5 !important; 
  }

  select,
  .quantity-select,
  .phone-row select {
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    appearance: none !important;
    position: relative;
    background: transparent;
    color: white;
    border: 1px solid rgba(255,255,255,0.5);
    border-radius: 6px;
    padding: 10px 36px 10px 10px;
    font-size: 1rem;
    cursor: pointer;
    background-image: url("data:image/svg+xml;utf8,<svg fill='%23ffffff' height='10' width='10' xmlns='http://www.w3.org/2000/svg'><path d='M0 0 L5 6 L10 0 Z'/></svg>");
    background-repeat: no-repeat;
    background-position: right 12px center;
    background-size: 12px;
  }

  .quantity-select {
    padding-right: 32px;
    background-position: right 8px center;
    background-size: 10px;
  }

  select:focus {
    border-color: #64d869;
    box-shadow: 0 0 5px rgba(100,216,105,0.4);
    outline: none;
  }
</style>

</head>
<body>
  <div id="main-content">
    <h2>Evento: Calema - Londres</h2>
    <button onclick="openCalemaSection()">Comprar</button>
  </div>

  <section id="calema-section">
    <div class="title-bar"><h2>CALEMA</h2></div>

    <div class="blob blob1"></div>
    <div class="blob blob2"></div>

    <div class="content">
      <div class="left-pane">
        <div class="ticket-info" id="ticketInfo">
          <div class="left-toolbar">
            <button class="back-btn-global" id="backBtn">← Voltar</button>
            <button class="promo-btn" id="promoBtn">Código Promocional</button>
          </div>

          <div class="coupon-section" id="couponSection">
            <input type="text" placeholder="código" id="couponInput">
            <button id="applyCoupon">Aplicar</button>
          </div>

          <div class="ticket-box" id="checkout-area">
            <h3>STANDART</h3>
            <div class="ticket-row">
              <p>Individual <span style="opacity:0.7;">Lote 1</span></p>
              <div class="price-row">
                <span>£ 48,00</span>
                <select id="ticketQty" class="quantity-select">
                  <option value="0" selected>0</option>
                  <option value="1">1</option><option value="2">2</option>
                  <option value="3">3</option><option value="4">4</option>
                  <option value="5">5</option><option value="6">6</option>
                  <option value="7">7</option><option value="8">8</option>
                  <option value="9">9</option><option value="10">10</option>
                </select>
              </div>
            </div>
          </div>
        </div>

        <div class="payment-form" id="paymentForm">
          <button class="back-btn-global" id="backBtnPayment">← Voltar</button>
          <div class="form-row">
            <div class="form-group"><input type="text" placeholder="Nome"></div>
            <div class="form-group"><input type="text" placeholder="Apelido"></div>
            <div class="form-group"><input type="email" placeholder="E-mail"></div>
            <div class="form-group phone-row">
              <select>
                <option>POR +351</option><option>BRA +55</option>
                <option>ITA +39</option><option>ESP +34</option>
                <option>SUI +41</option><option>FRA +33</option>
                <option>IRL +353</option><option>GBR +44</option>
                <option>BEL +32</option><option>GER +49</option>
                <option>NED +31</option><option>USA +1</option>
              </select>
              <input type="tel" placeholder="Número do Telemóvel">
            </div>
            <p style="margin: 20px 0;">Os bilhetes serão enviados por e-mail e WhatsApp.</p>
          </div>
          <div class="form-row last-row">
            <div class="form-group">
              <select>
                <option>Portugal</option><option>Espanha</option>
                <option>Brasil</option><option>Reino Unido</option>
              </select>
            </div>
            <div class="form-group"><input type="text" placeholder="Concelho"></div>
          </div>
          <div class="payment-actions">
            <button class="pay-continue-btn" id="payContinueBtn">Continuar</button>
          </div>
        </div>
      </div>

      <div class="cart-box" id="cartBox">
        <div class="cart-title">
          <svg xmlns="http://www.w3.org/2000/svg" class="cart-icon" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M7 18c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm10 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zM7.42 13l.75-2h8.11c.74 0 1.39-.4 1.73-1.01l3.57-6.46A1 1 0 0 0 20.59 2H5.21L4.27 0H1v2h2l3.6 7.5-1.35 2.45C4.52 13.4 5.48 15 7 15h12v-2H7.42z"/>
          </svg>
        </div>

        <div class="cart-item">
          <div class="cart-header">
            <p><strong>Calema</strong></p>
            <button class="remove-btn" id="removeBtn">✕</button>
          </div>
          <div class="cart-line">
            <span id="cartDetails">0x Standard Individual</span>
            <span id="cartSubtotal">£ 0,00</span>
          </div>
          <small>Valor total dos bilhetes <em>IVA incluído</em></small>
        </div>
        <hr>
        <div class="costs">
          <p>Custos de operação <span id="operCost">£ 0,00</span></p>
          <p>IVA sobre custos <span id="vatCost">£ 0,00</span></p>
        </div>
        <div class="total">
          <p><strong>TOTAL</strong> <span id="totalPrice">£ 0,00</span></p>
        </div>
        <button class="continue-btn" id="continueBtn">Continuar</button>
      </div>
    </div>
  </section>

<script>
const calemaSection=document.getElementById("calema-section");
const backBtn=document.getElementById("backBtn");
const qtySelect=document.getElementById("ticketQty");
const removeBtn=document.getElementById("removeBtn");
const promoBtn=document.getElementById("promoBtn");
const couponSection=document.getElementById("couponSection");
const ticketInfo=document.getElementById("ticketInfo");
const cartBox=document.getElementById("cartBox");
const paymentForm=document.getElementById("paymentForm");
const payContinueBtn=document.getElementById("payContinueBtn");
const backBtnPayment=document.getElementById("backBtnPayment");
const ticketPrice=48.00,operCost=2.88,vatCost=0.66;

const isMobile=()=>window.matchMedia("(max-width:768px)").matches;

function openCalemaSection(){
  calemaSection.style.display="block";
  requestAnimationFrame(()=>calemaSection.classList.add("active"));
}

qtySelect.addEventListener("change",()=>{
  const qty=parseInt(qtySelect.value);
  updateCart(qty);
  if(isMobile()){
    if(qty>0){cartBox.classList.add("visible");cartBox.style.display="block";}
    else{cartBox.classList.remove("visible");cartBox.style.display="none";}
  }
});

function updateCart(qty){
  const subtotal=qty*ticketPrice;
  const oper=qty>0?operCost:0;
  const vat=qty>0?vatCost:0;
  const total=subtotal+oper+vat;
  document.getElementById("cartSubtotal").textContent=`£ ${subtotal.toFixed(2)}`;
  document.getElementById("operCost").textContent=`£ ${oper.toFixed(2)}`;
  document.getElementById("vatCost").textContent=`£ ${vat.toFixed(2)}`;
  document.getElementById("totalPrice").textContent=`£ ${total.toFixed(2)}`;
  document.getElementById("cartDetails").textContent=`${qty}x Standard Individual`;
  removeBtn.style.display=qty>0?"inline-block":"none";
}

removeBtn.onclick=()=>{qtySelect.value="0";updateCart(0);if(isMobile()){cartBox.classList.remove("visible");cartBox.style.display="none";}};

promoBtn.onclick=()=>{promoBtn.style.display="none";couponSection.style.display="flex";couponSection.scrollIntoView({behavior:"smooth"});};

document.getElementById("continueBtn").onclick=()=>{
  if(isMobile()){
    ticketInfo.style.display="none";cartBox.style.display="none";
    paymentForm.style.display="block";requestAnimationFrame(()=>paymentForm.classList.add("active"));
    calemaSection.scrollTo({top:0,behavior:"smooth"});
  }else{
    ticketInfo.style.display="none";
    cartBox.style.removeProperty("display");
    paymentForm.style.display="block";
    requestAnimationFrame(()=>paymentForm.classList.add("active"));
  }
};

backBtn.onclick=()=>{
  if(paymentForm.classList.contains("active")){
    paymentForm.classList.remove("active");
    setTimeout(()=>{
      paymentForm.style.display="none";ticketInfo.style.display="block";
      if(isMobile()){
        const qty=parseInt(qtySelect.value);
        if(qty>0){cartBox.classList.add("visible");cartBox.style.display="block";}
        else{cartBox.classList.remove("visible");cartBox.style.display="none";}
        calemaSection.scrollTo({top:0,behavior:"smooth"});
      }else{cartBox.style.removeProperty("display");}
    },150);
  }else{
    calemaSection.classList.remove("active");
    setTimeout(()=>calemaSection.style.display="none",350);
  }
};

backBtnPayment.onclick=()=>{
  paymentForm.classList.remove("active");
  setTimeout(()=>{
    paymentForm.style.display="none";
    ticketInfo.style.display="block";
    if(isMobile()){
      const qty=parseInt(qtySelect.value);
      if(qty>0){
        cartBox.classList.add("visible");
        cartBox.style.display="block";
      } else {
        cartBox.classList.remove("visible");
        cartBox.style.display="none";
      }
      calemaSection.scrollTo({top:0,behavior:"smooth"});
    } else {
      cartBox.style.removeProperty("display");
    }
  },150);
};

payContinueBtn.onclick=()=>{alert("Pagamento: continuar para o checkout/confirmar.");};

window.addEventListener("resize",()=>{if(!isMobile()&&paymentForm.classList.contains("active")){cartBox.style.removeProperty("display");}});
</script>
</body>
</html>
